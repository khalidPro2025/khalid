FROM dorowu/ubuntu-desktop-lxde-vnc
RUN apt-get update && apt-get install -y x11vnc
CMD ["/startup.sh"]


# Étape 1: Utiliser l'image de base Ubuntu 22.04
FROM ubuntu:22.04

# Étape 2: Définir l'environnement pour éviter les interactions utilisateur
ENV DEBIAN_FRONTEND=noninteractive

# Étape 3: Configurer le fuseau horaire par défaut (UTC)
RUN ln -fs /usr/share/zoneinfo/UTC /etc/localtime && \
    echo "UTC" > /etc/timezone

# Étape 4: Mettre à jour les paquets et installer les dépendances nécessaires
RUN apt-get update && apt-get install -y \
    tigervnc-standalone-server \
    novnc \
    && apt-get clean && rm -rf /var/lib/apt/lists/*

# Étape 5: Configurer VNC
RUN mkdir -p /root/.vnc && \
    echo "password" | vncpasswd -f > /root/.vnc/passwd && \
    chmod 600 /root/.vnc/passwd

# Étape 6: Copier et configurer le script VNC
COPY vncserver /usr/local/bin/vncserver
RUN chmod +x /usr/local/bin/vncserver

# Étape 7: Exposer les ports VNC et noVNC
EXPOSE 5901 6901

# Étape 8: Définir la commande par défaut pour démarrer le serveur VNC
CMD ["vncserver", ":1", "-geometry", "1280x800", "-depth", "24"]
